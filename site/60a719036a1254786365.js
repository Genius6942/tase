function _typeof(t) { return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(t) { return typeof t } : function(t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, _typeof(t) } !function() { var t = { 38: function(t, e) { function n(t) { if (t) return function(t) { for (var e in n.prototype) t[e] = n.prototype[e]; return t }(t) } e.Q = n, n.prototype.on = n.prototype.addEventListener = function(t, e) { return this._callbacks = this._callbacks || {}, (this._callbacks["$" + t] = this._callbacks["$" + t] || []).push(e), this }, n.prototype.once = function(t, e) { function n() { this.off(t, n), e.apply(this, arguments) } return n.fn = e, this.on(t, n), this }, n.prototype.off = n.prototype.removeListener = n.prototype.removeAllListeners = n.prototype.removeEventListener = function(t, e) { if (this._callbacks = this._callbacks || {}, 0 == arguments.length) return this._callbacks = {}, this; var n, r = this._callbacks["$" + t]; if (!r) return this; if (1 == arguments.length) return delete this._callbacks["$" + t], this; for (var o = 0; o < r.length; o++)if ((n = r[o]) === e || n.fn === e) { r.splice(o, 1); break } return 0 === r.length && delete this._callbacks["$" + t], this }, n.prototype.emit = function(t) { this._callbacks = this._callbacks || {}; for (var e = new Array(arguments.length - 1), n = this._callbacks["$" + t], r = 1; r < arguments.length; r++)e[r - 1] = arguments[r]; if (n) { r = 0; for (var o = (n = n.slice(0)).length; r < o; ++r)n[r].apply(this, e) } return this }, n.prototype.emitReserved = n.prototype.emit, n.prototype.listeners = function(t) { return this._callbacks = this._callbacks || {}, this._callbacks["$" + t] || [] }, n.prototype.hasListeners = function(t) { return !!this.listeners(t).length } }, 28: function(t) { function e(t) { t = t || {}, this.ms = t.min || 100, this.max = t.max || 1e4, this.factor = t.factor || 2, this.jitter = t.jitter > 0 && t.jitter <= 1 ? t.jitter : 0, this.attempts = 0 } t.exports = e, e.prototype.duration = function() { var t = this.ms * Math.pow(this.factor, this.attempts++); if (this.jitter) { var e = Math.random(), n = Math.floor(e * this.jitter * t); t = 0 == (1 & Math.floor(10 * e)) ? t - n : t + n } return 0 | Math.min(t, this.max) }, e.prototype.reset = function() { this.attempts = 0 }, e.prototype.setMin = function(t) { this.ms = t }, e.prototype.setMax = function(t) { this.max = t }, e.prototype.setJitter = function(t) { this.jitter = t } }, 129: function(t) { try { t.exports = "undefined" != typeof XMLHttpRequest && "withCredentials" in new XMLHttpRequest } catch (e) { t.exports = !1 } }, 482: function(t, e) { e.encode = function(t) { var e = ""; for (var n in t) t.hasOwnProperty(n) && (e.length && (e += "&"), e += encodeURIComponent(n) + "=" + encodeURIComponent(t[n])); return e }, e.decode = function(t) { for (var e = {}, n = t.split("&"), r = 0, o = n.length; r < o; r++) { var i = n[r].split("="); e[decodeURIComponent(i[0])] = decodeURIComponent(i[1]) } return e } }, 263: function(t) { var e = /^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/, n = ["source", "protocol", "authority", "userInfo", "user", "password", "host", "port", "relative", "path", "directory", "file", "query", "anchor"]; t.exports = function(t) { var r, o, i = t, s = t.indexOf("["), a = t.indexOf("]"); -1 != s && -1 != a && (t = t.substring(0, s) + t.substring(s, a).replace(/:/g, ";") + t.substring(a, t.length)); for (var c, u, f = e.exec(t || ""), l = {}, h = 14; h--;)l[n[h]] = f[h] || ""; return -1 != s && -1 != a && (l.source = i, l.host = l.host.substring(1, l.host.length - 1).replace(/;/g, ":"), l.authority = l.authority.replace("[", "").replace("]", "").replace(/;/g, ":"), l.ipv6uri = !0), l.pathNames = (o = (r = l.path).replace(/\/{2,9}/g, "/").split("/"), "/" != r.substr(0, 1) && 0 !== r.length || o.splice(0, 1), "/" == r.substr(r.length - 1, 1) && o.splice(o.length - 1, 1), o), l.queryKey = (c = l.query, u = {}, c.replace(/(?:^|&)([^&=]*)=?([^&]*)/g, (function(t, e, n) { e && (u[e] = n) })), u), l } }, 226: function(t) { "use strict"; var e, n = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""), r = {}, o = 0, i = 0; function s(t) { var e = ""; do { e = n[t % 64] + e, t = Math.floor(t / 64) } while (t > 0); return e } function a() { var t = s(+new Date); return t !== e ? (o = 0, e = t) : t + "." + s(o++) } for (; i < 64; i++)r[n[i]] = i; a.encode = s, a.decode = function(t) { var e = 0; for (i = 0; i < t.length; i++)e = 64 * e + r[t.charAt(i)]; return e }, t.exports = a } }, e = {}; function n(r) { var o = e[r]; if (void 0 !== o) return o.exports; var i = e[r] = { exports: {} }; return t[r](i, i.exports, n), i.exports } n.d = function(t, e) { for (var r in e) n.o(e, r) && !n.o(t, r) && Object.defineProperty(t, r, { enumerable: !0, get: e[r] }) }, n.o = function(t, e) { return Object.prototype.hasOwnProperty.call(t, e) }, n.r = function(t) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(t, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(t, "__esModule", { value: !0 }) }, function() { "use strict"; var t = {}; n.r(t), n.d(t, { Decoder: function() { return Yt }, Encoder: function() { return Wt }, PacketType: function() { return Ut }, protocol: function() { return Vt } }); var e = n(263), r = n(129), o = "undefined" != typeof self ? self : "undefined" != typeof window ? window : Function("return this")(); function i(t) { var e = t.xdomain; try { if ("undefined" != typeof XMLHttpRequest && (!e || r)) return new XMLHttpRequest } catch (t) { } if (!e) try { return new (o[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP") } catch (t) { } } function s(t) { for (var e = arguments.length, n = new Array(e > 1 ? e - 1 : 0), r = 1; r < e; r++)n[r - 1] = arguments[r]; return n.reduce((function(e, n) { return t.hasOwnProperty(n) && (e[n] = t[n]), e }), {}) } var a = setTimeout, c = clearTimeout; function u(t, e) { e.useNativeTimers ? (t.setTimeoutFn = a.bind(o), t.clearTimeoutFn = c.bind(o)) : (t.setTimeoutFn = setTimeout.bind(o), t.clearTimeoutFn = clearTimeout.bind(o)) } var f = n(38), l = Object.create(null); l.open = "0", l.close = "1", l.ping = "2", l.pong = "3", l.message = "4", l.upgrade = "5", l.noop = "6"; var h = Object.create(null); Object.keys(l).forEach((function(t) { h[l[t]] = t })); for (var p = { type: "error", data: "parser error" }, y = "function" == typeof Blob || "undefined" != typeof Blob && "[object BlobConstructor]" === Object.prototype.toString.call(Blob), d = "function" == typeof ArrayBuffer, v = function(t, e) { var n = new FileReader; return n.onload = function() { var t = n.result.split(",")[1]; e("b" + t) }, n.readAsDataURL(t) }, m = function(t, e, n) { var r, o = t.type, i = t.data; return y && i instanceof Blob ? e ? n(i) : v(i, n) : d && (i instanceof ArrayBuffer || (r = i, "function" == typeof ArrayBuffer.isView ? ArrayBuffer.isView(r) : r && r.buffer instanceof ArrayBuffer)) ? e ? n(i) : v(new Blob([i]), n) : n(l[o] + (i || "")) }, b = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/", g = "undefined" == typeof Uint8Array ? [] : new Uint8Array(256), w = 0; w < b.length; w++)g[b.charCodeAt(w)] = w; var k = "function" == typeof ArrayBuffer, _ = function(t, e) { if (k) { var n = function(t) { var e, n, r, o, i, s = .75 * t.length, a = t.length, c = 0; "=" === t[t.length - 1] && (s-- , "=" === t[t.length - 2] && s--); var u = new ArrayBuffer(s), f = new Uint8Array(u); for (e = 0; e < a; e += 4)n = g[t.charCodeAt(e)], r = g[t.charCodeAt(e + 1)], o = g[t.charCodeAt(e + 2)], i = g[t.charCodeAt(e + 3)], f[c++] = n << 2 | r >> 4, f[c++] = (15 & r) << 4 | o >> 2, f[c++] = (3 & o) << 6 | 63 & i; return u }(t); return O(n, e) } return { base64: !0, data: t } }, O = function(t, e) { return "blob" === e && t instanceof ArrayBuffer ? new Blob([t]) : t }, S = function(t, e) { if ("string" != typeof t) return { type: "message", data: O(t, e) }; var n = t.charAt(0); return "b" === n ? { type: "message", data: _(t.substring(1), e) } : h[n] ? t.length > 1 ? { type: h[n], data: t.substring(1) } : { type: h[n] } : p }, x = String.fromCharCode(30); function R(t) { return R = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function(t) { return _typeof(t) } : function(t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : _typeof(t) }, R(t) } function E() { return E = "undefined" != typeof Reflect && Reflect.get ? Reflect.get : function(t, e, n) { var r = T(t, e); if (r) { var o = Object.getOwnPropertyDescriptor(r, e); return o.get ? o.get.call(arguments.length < 3 ? t : n) : o.value } }, E.apply(this, arguments) } function T(t, e) { for (; !Object.prototype.hasOwnProperty.call(t, e) && null !== (t = C(t));); return t } function P(t, e) { return P = Object.setPrototypeOf || function(t, e) { return t.__proto__ = e, t }, P(t, e) } function A(t, e) { if (e && ("object" === R(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return j(t) } function j(t) { if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return t } function C(t) { return C = Object.setPrototypeOf ? Object.getPrototypeOf : function(t) { return t.__proto__ || Object.getPrototypeOf(t) }, C(t) } var B = function(t) { !function(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), e && P(t, e) }(i, t); var e, n, r, o = (n = i, r = function() { if ("undefined" == typeof Reflect || !Reflect.construct) return !1; if (Reflect.construct.sham) return !1; if ("function" == typeof Proxy) return !0; try { return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() { }))), !0 } catch (t) { return !1 } }(), function() { var t, e = C(n); if (r) { var o = C(this).constructor; t = Reflect.construct(e, arguments, o) } else t = e.apply(this, arguments); return A(this, t) }); function i(t) { var e; return function(t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") }(this, i), (e = o.call(this)).writable = !1, u(j(e), t), e.opts = t, e.query = t.query, e.readyState = "", e.socket = t.socket, e } return (e = [{ key: "onError", value: function(t, e) { var n = new Error(t); return n.type = "TransportError", n.description = e, E(C(i.prototype), "emit", this).call(this, "error", n), this } }, { key: "open", value: function() { return "closed" !== this.readyState && "" !== this.readyState || (this.readyState = "opening", this.doOpen()), this } }, { key: "close", value: function() { return "opening" !== this.readyState && "open" !== this.readyState || (this.doClose(), this.onClose()), this } }, { key: "send", value: function(t) { "open" === this.readyState && this.write(t) } }, { key: "onOpen", value: function() { this.readyState = "open", this.writable = !0, E(C(i.prototype), "emit", this).call(this, "open") } }, { key: "onData", value: function(t) { var e = S(t, this.socket.binaryType); this.onPacket(e) } }, { key: "onPacket", value: function(t) { E(C(i.prototype), "emit", this).call(this, "packet", t) } }, { key: "onClose", value: function() { this.readyState = "closed", E(C(i.prototype), "emit", this).call(this, "close") } }]) && function(t, e) { for (var n = 0; n < e.length; n++) { var r = e[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(t, r.key, r) } }(i.prototype, e), i }(f.Q), N = n(226), L = n(482); function I(t) { return I = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function(t) { return _typeof(t) } : function(t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : _typeof(t) }, I(t) } function D(t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") } function M(t, e) { return M = Object.setPrototypeOf || function(t, e) { return t.__proto__ = e, t }, M(t, e) } function q(t, e) { if (e && ("object" === I(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return function(t) { if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return t }(t) } function H(t) { return H = Object.setPrototypeOf ? Object.getPrototypeOf : function(t) { return t.__proto__ || Object.getPrototypeOf(t) }, H(t) } var F = function(t) { !function(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), e && M(t, e) }(i, t); var e, n, r, o = (n = i, r = function() { if ("undefined" == typeof Reflect || !Reflect.construct) return !1; if (Reflect.construct.sham) return !1; if ("function" == typeof Proxy) return !0; try { return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() { }))), !0 } catch (t) { return !1 } }(), function() { var t, e = H(n); if (r) { var o = H(this).constructor; t = Reflect.construct(e, arguments, o) } else t = e.apply(this, arguments); return q(this, t) }); function i() { var t; return D(this, i), (t = o.apply(this, arguments)).polling = !1, t } return e = [{ key: "name", get: function() { return "polling" } }, { key: "doOpen", value: function() { this.poll() } }, { key: "pause", value: function(t) { var e = this; this.readyState = "pausing"; var n = function() { e.readyState = "paused", t() }; if (this.polling || !this.writable) { var r = 0; this.polling && (r++ , this.once("pollComplete", (function() { --r || n() }))), this.writable || (r++ , this.once("drain", (function() { --r || n() }))) } else n() } }, { key: "poll", value: function() { this.polling = !0, this.doPoll(), this.emit("poll") } }, { key: "onData", value: function(t) { var e = this; (function(t, e) { for (var n = t.split(x), r = [], o = 0; o < n.length; o++) { var i = S(n[o], e); if (r.push(i), "error" === i.type) break } return r })(t, this.socket.binaryType).forEach((function(t) { if ("opening" === e.readyState && "open" === t.type && e.onOpen(), "close" === t.type) return e.onClose(), !1; e.onPacket(t) })), "closed" !== this.readyState && (this.polling = !1, this.emit("pollComplete"), "open" === this.readyState && this.poll()) } }, { key: "doClose", value: function() { var t = this, e = function() { t.write([{ type: "close" }]) }; "open" === this.readyState ? e() : this.once("open", e) } }, { key: "write", value: function(t) { var e = this; this.writable = !1, function(t, n) { var r = t.length, o = new Array(r), i = 0; t.forEach((function(t, n) { m(t, !1, (function(t) { var s; o[n] = t, ++i === r && (s = o.join(x), e.doWrite(s, (function() { e.writable = !0, e.emit("drain") }))) })) })) }(t) } }, { key: "uri", value: function() { var t = this.query || {}, e = this.opts.secure ? "https" : "http", n = ""; !1 !== this.opts.timestampRequests && (t[this.opts.timestampParam] = N()), this.supportsBinary || t.sid || (t.b64 = 1), this.opts.port && ("https" === e && 443 !== Number(this.opts.port) || "http" === e && 80 !== Number(this.opts.port)) && (n = ":" + this.opts.port); var r = L.encode(t); return e + "://" + (-1 !== this.opts.hostname.indexOf(":") ? "[" + this.opts.hostname + "]" : this.opts.hostname) + n + this.opts.path + (r.length ? "?" + r : "") } }], e && function(t, e) { for (var n = 0; n < e.length; n++) { var r = e[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(t, r.key, r) } }(i.prototype, e), i }(B); function z(t) { return z = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function(t) { return _typeof(t) } : function(t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : _typeof(t) }, z(t) } function U() { return U = Object.assign || function(t) { for (var e = 1; e < arguments.length; e++) { var n = arguments[e]; for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (t[r] = n[r]) } return t }, U.apply(this, arguments) } function V(t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") } function W(t, e) { for (var n = 0; n < e.length; n++) { var r = e[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(t, r.key, r) } } function Y(t, e, n) { return e && W(t.prototype, e), n && W(t, n), t } function K(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), e && J(t, e) } function J(t, e) { return J = Object.setPrototypeOf || function(t, e) { return t.__proto__ = e, t }, J(t, e) } function X(t) { var e = function() { if ("undefined" == typeof Reflect || !Reflect.construct) return !1; if (Reflect.construct.sham) return !1; if ("function" == typeof Proxy) return !0; try { return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() { }))), !0 } catch (t) { return !1 } }(); return function() { var n, r = Z(t); if (e) { var o = Z(this).constructor; n = Reflect.construct(r, arguments, o) } else n = r.apply(this, arguments); return Q(this, n) } } function Q(t, e) { if (e && ("object" === z(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return G(t) } function G(t) { if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return t } function Z(t) { return Z = Object.setPrototypeOf ? Object.getPrototypeOf : function(t) { return t.__proto__ || Object.getPrototypeOf(t) }, Z(t) } function tt() { } var et = null != new i({ xdomain: !1 }).responseType, nt = function(t) { K(n, t); var e = X(n); function n(t) { var r; if (V(this, n), r = e.call(this, t), "undefined" != typeof location) { var o = "https:" === location.protocol, i = location.port; i || (i = o ? "443" : "80"), r.xd = "undefined" != typeof location && t.hostname !== location.hostname || i !== t.port, r.xs = t.secure !== o } var s = t && t.forceBase64; return r.supportsBinary = et && !s, r } return Y(n, [{ key: "request", value: function() { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; return U(t, { xd: this.xd, xs: this.xs }, this.opts), new rt(this.uri(), t) } }, { key: "doWrite", value: function(t, e) { var n = this, r = this.request({ method: "POST", data: t }); r.on("success", e), r.on("error", (function(t) { n.onError("xhr post error", t) })) } }, { key: "doPoll", value: function() { var t = this, e = this.request(); e.on("data", this.onData.bind(this)), e.on("error", (function(e) { t.onError("xhr poll error", e) })), this.pollXhr = e } }]), n }(F), rt = function(t) { K(n, t); var e = X(n); function n(t, r) { var o; return V(this, n), u(G(o = e.call(this)), r), o.opts = r, o.method = r.method || "GET", o.uri = t, o.async = !1 !== r.async, o.data = void 0 !== r.data ? r.data : null, o.create(), o } return Y(n, [{ key: "create", value: function() { var t = this, e = s(this.opts, "agent", "pfx", "key", "passphrase", "cert", "ca", "ciphers", "rejectUnauthorized", "autoUnref"); e.xdomain = !!this.opts.xd, e.xscheme = !!this.opts.xs; var r = this.xhr = new i(e); try { r.open(this.method, this.uri, this.async); try { if (this.opts.extraHeaders) for (var o in r.setDisableHeaderCheck && r.setDisableHeaderCheck(!0), this.opts.extraHeaders) this.opts.extraHeaders.hasOwnProperty(o) && r.setRequestHeader(o, this.opts.extraHeaders[o]) } catch (t) { } if ("POST" === this.method) try { r.setRequestHeader("Content-type", "text/plain;charset=UTF-8") } catch (t) { } try { r.setRequestHeader("Accept", "*/*") } catch (t) { } "withCredentials" in r && (r.withCredentials = this.opts.withCredentials), this.opts.requestTimeout && (r.timeout = this.opts.requestTimeout), r.onreadystatechange = function() { 4 === r.readyState && (200 === r.status || 1223 === r.status ? t.onLoad() : t.setTimeoutFn((function() { t.onError("number" == typeof r.status ? r.status : 0) }), 0)) }, r.send(this.data) } catch (e) { return void this.setTimeoutFn((function() { t.onError(e) }), 0) } "undefined" != typeof document && (this.index = n.requestsCount++ , n.requests[this.index] = this) } }, { key: "onSuccess", value: function() { this.emit("success"), this.cleanup() } }, { key: "onData", value: function(t) { this.emit("data", t), this.onSuccess() } }, { key: "onError", value: function(t) { this.emit("error", t), this.cleanup(!0) } }, { key: "cleanup", value: function(t) { if (void 0 !== this.xhr && null !== this.xhr) { if (this.xhr.onreadystatechange = tt, t) try { this.xhr.abort() } catch (t) { } "undefined" != typeof document && delete n.requests[this.index], this.xhr = null } } }, { key: "onLoad", value: function() { var t = this.xhr.responseText; null !== t && this.onData(t) } }, { key: "abort", value: function() { this.cleanup() } }]), n }(f.Q); function ot() { for (var t in rt.requests) rt.requests.hasOwnProperty(t) && rt.requests[t].abort() } rt.requestsCount = 0, rt.requests = {}, "undefined" != typeof document && ("function" == typeof attachEvent ? attachEvent("onunload", ot) : "function" == typeof addEventListener && addEventListener("onpagehide" in o ? "pagehide" : "unload", ot, !1)); var it = "function" == typeof Promise && "function" == typeof Promise.resolve ? function(t) { return Promise.resolve().then(t) } : function(t, e) { return e(t, 0) }, st = o.WebSocket || o.MozWebSocket; function at(t) { return at = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function(t) { return _typeof(t) } : function(t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : _typeof(t) }, at(t) } function ct(t, e) { return ct = Object.setPrototypeOf || function(t, e) { return t.__proto__ = e, t }, ct(t, e) } function ut(t, e) { if (e && ("object" === at(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return function(t) { if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return t }(t) } function ft(t) { return ft = Object.setPrototypeOf ? Object.getPrototypeOf : function(t) { return t.__proto__ || Object.getPrototypeOf(t) }, ft(t) } var lt = "undefined" != typeof navigator && "string" == typeof navigator.product && "reactnative" === navigator.product.toLowerCase(), ht = function(t) { !function(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), e && ct(t, e) }(i, t); var e, n, r, o = (n = i, r = function() { if ("undefined" == typeof Reflect || !Reflect.construct) return !1; if (Reflect.construct.sham) return !1; if ("function" == typeof Proxy) return !0; try { return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() { }))), !0 } catch (t) { return !1 } }(), function() { var t, e = ft(n); if (r) { var o = ft(this).constructor; t = Reflect.construct(e, arguments, o) } else t = e.apply(this, arguments); return ut(this, t) }); function i(t) { var e; return function(t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") }(this, i), (e = o.call(this, t)).supportsBinary = !t.forceBase64, e } return e = [{ key: "name", get: function() { return "websocket" } }, { key: "doOpen", value: function() { if (this.check()) { var t = this.uri(), e = this.opts.protocols, n = lt ? {} : s(this.opts, "agent", "perMessageDeflate", "pfx", "key", "passphrase", "cert", "ca", "ciphers", "rejectUnauthorized", "localAddress", "protocolVersion", "origin", "maxPayload", "family", "checkServerIdentity"); this.opts.extraHeaders && (n.headers = this.opts.extraHeaders); try { this.ws = lt ? new st(t, e, n) : e ? new st(t, e) : new st(t) } catch (t) { return this.emit("error", t) } this.ws.binaryType = this.socket.binaryType || "arraybuffer", this.addEventListeners() } } }, { key: "addEventListeners", value: function() { var t = this; this.ws.onopen = function() { t.opts.autoUnref && t.ws._socket.unref(), t.onOpen() }, this.ws.onclose = this.onClose.bind(this), this.ws.onmessage = function(e) { return t.onData(e.data) }, this.ws.onerror = function(e) { return t.onError("websocket error", e) } } }, { key: "write", value: function(t) { var e = this; this.writable = !1; for (var n = function(n) { var r = t[n], o = n === t.length - 1; m(r, e.supportsBinary, (function(t) { try { e.ws.send(t) } catch (t) { } o && it((function() { e.writable = !0, e.emit("drain") }), e.setTimeoutFn) })) }, r = 0; r < t.length; r++)n(r) } }, { key: "doClose", value: function() { void 0 !== this.ws && (this.ws.close(), this.ws = null) } }, { key: "uri", value: function() { var t = this.query || {}, e = this.opts.secure ? "wss" : "ws", n = ""; this.opts.port && ("wss" === e && 443 !== Number(this.opts.port) || "ws" === e && 80 !== Number(this.opts.port)) && (n = ":" + this.opts.port), this.opts.timestampRequests && (t[this.opts.timestampParam] = N()), this.supportsBinary || (t.b64 = 1); var r = L.encode(t); return e + "://" + (-1 !== this.opts.hostname.indexOf(":") ? "[" + this.opts.hostname + "]" : this.opts.hostname) + n + this.opts.path + (r.length ? "?" + r : "") } }, { key: "check", value: function() { return !(!st || "__initialize" in st && this.name === i.prototype.name) } }], e && function(t, e) { for (var n = 0; n < e.length; n++) { var r = e[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(t, r.key, r) } }(i.prototype, e), i }(B), pt = { websocket: ht, polling: nt }; function yt() { return yt = Object.assign || function(t) { for (var e = 1; e < arguments.length; e++) { var n = arguments[e]; for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (t[r] = n[r]) } return t }, yt.apply(this, arguments) } function dt(t) { return dt = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function(t) { return _typeof(t) } : function(t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : _typeof(t) }, dt(t) } function vt(t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") } function mt(t, e) { return mt = Object.setPrototypeOf || function(t, e) { return t.__proto__ = e, t }, mt(t, e) } function bt(t, e) { if (e && ("object" === dt(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return gt(t) } function gt(t) { if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return t } function wt(t) { return wt = Object.setPrototypeOf ? Object.getPrototypeOf : function(t) { return t.__proto__ || Object.getPrototypeOf(t) }, wt(t) } var kt = function(t) { !function(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), e && mt(t, e) }(s, t); var n, r, o, i = (r = s, o = function() { if ("undefined" == typeof Reflect || !Reflect.construct) return !1; if (Reflect.construct.sham) return !1; if ("function" == typeof Proxy) return !0; try { return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() { }))), !0 } catch (t) { return !1 } }(), function() { var t, e = wt(r); if (o) { var n = wt(this).constructor; t = Reflect.construct(e, arguments, n) } else t = e.apply(this, arguments); return bt(this, t) }); function s(t) { var n, r = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; return vt(this, s), n = i.call(this), t && "object" === dt(t) && (r = t, t = null), t ? (t = e(t), r.hostname = t.host, r.secure = "https" === t.protocol || "wss" === t.protocol, r.port = t.port, t.query && (r.query = t.query)) : r.host && (r.hostname = e(r.host).host), u(gt(n), r), n.secure = null != r.secure ? r.secure : "undefined" != typeof location && "https:" === location.protocol, r.hostname && !r.port && (r.port = n.secure ? "443" : "80"), n.hostname = r.hostname || ("undefined" != typeof location ? location.hostname : "localhost"), n.port = r.port || ("undefined" != typeof location && location.port ? location.port : n.secure ? "443" : "80"), n.transports = r.transports || ["polling", "websocket"], n.readyState = "", n.writeBuffer = [], n.prevBufferLen = 0, n.opts = yt({ path: "/engine.io", agent: !1, withCredentials: !1, upgrade: !0, timestampParam: "t", rememberUpgrade: !1, rejectUnauthorized: !0, perMessageDeflate: { threshold: 1024 }, transportOptions: {}, closeOnBeforeunload: !0 }, r), n.opts.path = n.opts.path.replace(/\/$/, "") + "/", "string" == typeof n.opts.query && (n.opts.query = L.decode(n.opts.query)), n.id = null, n.upgrades = null, n.pingInterval = null, n.pingTimeout = null, n.pingTimeoutTimer = null, "function" == typeof addEventListener && (n.opts.closeOnBeforeunload && addEventListener("beforeunload", (function() { n.transport && (n.transport.removeAllListeners(), n.transport.close()) }), !1), "localhost" !== n.hostname && (n.offlineEventListener = function() { n.onClose("transport close") }, addEventListener("offline", n.offlineEventListener, !1))), n.open(), n } return n = [{ key: "createTransport", value: function(t) { var e = function(t) { var e = {}; for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]); return e }(this.opts.query); e.EIO = 4, e.transport = t, this.id && (e.sid = this.id); var n = yt({}, this.opts.transportOptions[t], this.opts, { query: e, socket: this, hostname: this.hostname, secure: this.secure, port: this.port }); return new pt[t](n) } }, { key: "open", value: function() { var t, e = this; if (this.opts.rememberUpgrade && s.priorWebsocketSuccess && -1 !== this.transports.indexOf("websocket")) t = "websocket"; else { if (0 === this.transports.length) return void this.setTimeoutFn((function() { e.emitReserved("error", "No transports available") }), 0); t = this.transports[0] } this.readyState = "opening"; try { t = this.createTransport(t) } catch (t) { return this.transports.shift(), void this.open() } t.open(), this.setTransport(t) } }, { key: "setTransport", value: function(t) { var e = this; this.transport && this.transport.removeAllListeners(), this.transport = t, t.on("drain", this.onDrain.bind(this)).on("packet", this.onPacket.bind(this)).on("error", this.onError.bind(this)).on("close", (function() { e.onClose("transport close") })) } }, { key: "probe", value: function(t) { var e = this, n = this.createTransport(t), r = !1; s.priorWebsocketSuccess = !1; var o = function() { r || (n.send([{ type: "ping", data: "probe" }]), n.once("packet", (function(t) { if (!r) if ("pong" === t.type && "probe" === t.data) { if (e.upgrading = !0, e.emitReserved("upgrading", n), !n) return; s.priorWebsocketSuccess = "websocket" === n.name, e.transport.pause((function() { r || "closed" !== e.readyState && (l(), e.setTransport(n), n.send([{ type: "upgrade" }]), e.emitReserved("upgrade", n), n = null, e.upgrading = !1, e.flush()) })) } else { var o = new Error("probe error"); o.transport = n.name, e.emitReserved("upgradeError", o) } }))) }; function i() { r || (r = !0, l(), n.close(), n = null) } var a = function(t) { var r = new Error("probe error: " + t); r.transport = n.name, i(), e.emitReserved("upgradeError", r) }; function c() { a("transport closed") } function u() { a("socket closed") } function f(t) { n && t.name !== n.name && i() } var l = function() { n.removeListener("open", o), n.removeListener("error", a), n.removeListener("close", c), e.off("close", u), e.off("upgrading", f) }; n.once("open", o), n.once("error", a), n.once("close", c), this.once("close", u), this.once("upgrading", f), n.open() } }, { key: "onOpen", value: function() { if (this.readyState = "open", s.priorWebsocketSuccess = "websocket" === this.transport.name, this.emitReserved("open"), this.flush(), "open" === this.readyState && this.opts.upgrade && this.transport.pause) for (var t = 0, e = this.upgrades.length; t < e; t++)this.probe(this.upgrades[t]) } }, { key: "onPacket", value: function(t) { if ("opening" === this.readyState || "open" === this.readyState || "closing" === this.readyState) switch (this.emitReserved("packet", t), this.emitReserved("heartbeat"), t.type) { case "open": this.onHandshake(JSON.parse(t.data)); break; case "ping": this.resetPingTimeout(), this.sendPacket("pong"), this.emitReserved("ping"), this.emitReserved("pong"); break; case "error": var e = new Error("server error"); e.code = t.data, this.onError(e); break; case "message": this.emitReserved("data", t.data), this.emitReserved("message", t.data) } } }, { key: "onHandshake", value: function(t) { this.emitReserved("handshake", t), this.id = t.sid, this.transport.query.sid = t.sid, this.upgrades = this.filterUpgrades(t.upgrades), this.pingInterval = t.pingInterval, this.pingTimeout = t.pingTimeout, this.onOpen(), "closed" !== this.readyState && this.resetPingTimeout() } }, { key: "resetPingTimeout", value: function() { var t = this; this.clearTimeoutFn(this.pingTimeoutTimer), this.pingTimeoutTimer = this.setTimeoutFn((function() { t.onClose("ping timeout") }), this.pingInterval + this.pingTimeout), this.opts.autoUnref && this.pingTimeoutTimer.unref() } }, { key: "onDrain", value: function() { this.writeBuffer.splice(0, this.prevBufferLen), this.prevBufferLen = 0, 0 === this.writeBuffer.length ? this.emitReserved("drain") : this.flush() } }, { key: "flush", value: function() { "closed" !== this.readyState && this.transport.writable && !this.upgrading && this.writeBuffer.length && (this.transport.send(this.writeBuffer), this.prevBufferLen = this.writeBuffer.length, this.emitReserved("flush")) } }, { key: "write", value: function(t, e, n) { return this.sendPacket("message", t, e, n), this } }, { key: "send", value: function(t, e, n) { return this.sendPacket("message", t, e, n), this } }, { key: "sendPacket", value: function(t, e, n, r) { if ("function" == typeof e && (r = e, e = void 0), "function" == typeof n && (r = n, n = null), "closing" !== this.readyState && "closed" !== this.readyState) { (n = n || {}).compress = !1 !== n.compress; var o = { type: t, data: e, options: n }; this.emitReserved("packetCreate", o), this.writeBuffer.push(o), r && this.once("flush", r), this.flush() } } }, { key: "close", value: function() { var t = this, e = function() { t.onClose("forced close"), t.transport.close() }, n = function n() { t.off("upgrade", n), t.off("upgradeError", n), e() }, r = function() { t.once("upgrade", n), t.once("upgradeError", n) }; return "opening" !== this.readyState && "open" !== this.readyState || (this.readyState = "closing", this.writeBuffer.length ? this.once("drain", (function() { t.upgrading ? r() : e() })) : this.upgrading ? r() : e()), this } }, { key: "onError", value: function(t) { s.priorWebsocketSuccess = !1, this.emitReserved("error", t), this.onClose("transport error", t) } }, { key: "onClose", value: function(t, e) { "opening" !== this.readyState && "open" !== this.readyState && "closing" !== this.readyState || (this.clearTimeoutFn(this.pingTimeoutTimer), this.transport.removeAllListeners("close"), this.transport.close(), this.transport.removeAllListeners(), "function" == typeof removeEventListener && removeEventListener("offline", this.offlineEventListener, !1), this.readyState = "closed", this.id = null, this.emitReserved("close", t, e), this.writeBuffer = [], this.prevBufferLen = 0) } }, { key: "filterUpgrades", value: function(t) { for (var e = [], n = 0, r = t.length; n < r; n++)~this.transports.indexOf(t[n]) && e.push(t[n]); return e } }], n && function(t, e) { for (var n = 0; n < e.length; n++) { var r = e[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(t, r.key, r) } }(s.prototype, n), s }(f.Q); function _t(t) { return _t = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function(t) { return _typeof(t) } : function(t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : _typeof(t) }, _t(t) } kt.protocol = 4, kt.protocol; var Ot = "function" == typeof ArrayBuffer, St = Object.prototype.toString, xt = "function" == typeof Blob || "undefined" != typeof Blob && "[object BlobConstructor]" === St.call(Blob), Rt = "function" == typeof File || "undefined" != typeof File && "[object FileConstructor]" === St.call(File); function Et(t) { return Ot && (t instanceof ArrayBuffer || function(t) { return "function" == typeof ArrayBuffer.isView ? ArrayBuffer.isView(t) : t.buffer instanceof ArrayBuffer }(t)) || xt && t instanceof Blob || Rt && t instanceof File } function Tt(t, e) { if (!t || "object" !== _t(t)) return !1; if (Array.isArray(t)) { for (var n = 0, r = t.length; n < r; n++)if (Tt(t[n])) return !0; return !1 } if (Et(t)) return !0; if (t.toJSON && "function" == typeof t.toJSON && 1 === arguments.length) return Tt(t.toJSON(), !0); for (var o in t) if (Object.prototype.hasOwnProperty.call(t, o) && Tt(t[o])) return !0; return !1 } function Pt(t) { return Pt = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function(t) { return _typeof(t) } : function(t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : _typeof(t) }, Pt(t) } function At(t) { var e = [], n = t.data, r = t; return r.data = jt(n, e), r.attachments = e.length, { packet: r, buffers: e } } function jt(t, e) { if (!t) return t; if (Et(t)) { var n = { _placeholder: !0, num: e.length }; return e.push(t), n } if (Array.isArray(t)) { for (var r = new Array(t.length), o = 0; o < t.length; o++)r[o] = jt(t[o], e); return r } if ("object" === Pt(t) && !(t instanceof Date)) { var i = {}; for (var s in t) t.hasOwnProperty(s) && (i[s] = jt(t[s], e)); return i } return t } function Ct(t, e) { return t.data = Bt(t.data, e), t.attachments = void 0, t } function Bt(t, e) { if (!t) return t; if (t && t._placeholder) return e[t.num]; if (Array.isArray(t)) for (var n = 0; n < t.length; n++)t[n] = Bt(t[n], e); else if ("object" === Pt(t)) for (var r in t) t.hasOwnProperty(r) && (t[r] = Bt(t[r], e)); return t } function Nt(t) { return Nt = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function(t) { return _typeof(t) } : function(t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : _typeof(t) }, Nt(t) } function Lt() { return Lt = "undefined" != typeof Reflect && Reflect.get ? Reflect.get : function(t, e, n) { var r = It(t, e); if (r) { var o = Object.getOwnPropertyDescriptor(r, e); return o.get ? o.get.call(arguments.length < 3 ? t : n) : o.value } }, Lt.apply(this, arguments) } function It(t, e) { for (; !Object.prototype.hasOwnProperty.call(t, e) && null !== (t = qt(t));); return t } function Dt(t, e) { return Dt = Object.setPrototypeOf || function(t, e) { return t.__proto__ = e, t }, Dt(t, e) } function Mt(t, e) { if (e && ("object" === Nt(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return function(t) { if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return t }(t) } function qt(t) { return qt = Object.setPrototypeOf ? Object.getPrototypeOf : function(t) { return t.__proto__ || Object.getPrototypeOf(t) }, qt(t) } function Ht(t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") } function Ft(t, e) { for (var n = 0; n < e.length; n++) { var r = e[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(t, r.key, r) } } function zt(t, e, n) { return e && Ft(t.prototype, e), n && Ft(t, n), t } var Ut, Vt = 5; !function(t) { t[t.CONNECT = 0] = "CONNECT", t[t.DISCONNECT = 1] = "DISCONNECT", t[t.EVENT = 2] = "EVENT", t[t.ACK = 3] = "ACK", t[t.CONNECT_ERROR = 4] = "CONNECT_ERROR", t[t.BINARY_EVENT = 5] = "BINARY_EVENT", t[t.BINARY_ACK = 6] = "BINARY_ACK" }(Ut || (Ut = {})); var Wt = function() { function t() { Ht(this, t) } return zt(t, [{ key: "encode", value: function(t) { return t.type !== Ut.EVENT && t.type !== Ut.ACK || !Tt(t) ? [this.encodeAsString(t)] : (t.type = t.type === Ut.EVENT ? Ut.BINARY_EVENT : Ut.BINARY_ACK, this.encodeAsBinary(t)) } }, { key: "encodeAsString", value: function(t) { var e = "" + t.type; return t.type !== Ut.BINARY_EVENT && t.type !== Ut.BINARY_ACK || (e += t.attachments + "-"), t.nsp && "/" !== t.nsp && (e += t.nsp + ","), null != t.id && (e += t.id), null != t.data && (e += JSON.stringify(t.data)), e } }, { key: "encodeAsBinary", value: function(t) { var e = At(t), n = this.encodeAsString(e.packet), r = e.buffers; return r.unshift(n), r } }]), t }(), Yt = function(t) { !function(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), e && Dt(t, e) }(o, t); var e, n, r = (e = o, n = function() { if ("undefined" == typeof Reflect || !Reflect.construct) return !1; if (Reflect.construct.sham) return !1; if ("function" == typeof Proxy) return !0; try { return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() { }))), !0 } catch (t) { return !1 } }(), function() { var t, r = qt(e); if (n) { var o = qt(this).constructor; t = Reflect.construct(r, arguments, o) } else t = r.apply(this, arguments); return Mt(this, t) }); function o() { return Ht(this, o), r.call(this) } return zt(o, [{ key: "add", value: function(t) { var e; if ("string" == typeof t) (e = this.decodeString(t)).type === Ut.BINARY_EVENT || e.type === Ut.BINARY_ACK ? (this.reconstructor = new $t(e), 0 === e.attachments && Lt(qt(o.prototype), "emitReserved", this).call(this, "decoded", e)) : Lt(qt(o.prototype), "emitReserved", this).call(this, "decoded", e); else { if (!Et(t) && !t.base64) throw new Error("Unknown type: " + t); if (!this.reconstructor) throw new Error("got binary data when not reconstructing a packet"); (e = this.reconstructor.takeBinaryData(t)) && (this.reconstructor = null, Lt(qt(o.prototype), "emitReserved", this).call(this, "decoded", e)) } } }, { key: "decodeString", value: function(t) { var e = 0, n = { type: Number(t.charAt(0)) }; if (void 0 === Ut[n.type]) throw new Error("unknown packet type " + n.type); if (n.type === Ut.BINARY_EVENT || n.type === Ut.BINARY_ACK) { for (var r = e + 1; "-" !== t.charAt(++e) && e != t.length;); var i = t.substring(r, e); if (i != Number(i) || "-" !== t.charAt(e)) throw new Error("Illegal attachments"); n.attachments = Number(i) } if ("/" === t.charAt(e + 1)) { for (var s = e + 1; ++e && "," !== t.charAt(e) && e !== t.length;); n.nsp = t.substring(s, e) } else n.nsp = "/"; var a = t.charAt(e + 1); if ("" !== a && Number(a) == a) { for (var c = e + 1; ++e;) { var u = t.charAt(e); if (null == u || Number(u) != u) { --e; break } if (e === t.length) break } n.id = Number(t.substring(c, e + 1)) } if (t.charAt(++e)) { var f = function(t) { try { return JSON.parse(t) } catch (t) { return !1 } }(t.substr(e)); if (!o.isPayloadValid(n.type, f)) throw new Error("invalid payload"); n.data = f } return n } }, { key: "destroy", value: function() { this.reconstructor && this.reconstructor.finishedReconstruction() } }], [{ key: "isPayloadValid", value: function(t, e) { switch (t) { case Ut.CONNECT: return "object" === Nt(e); case Ut.DISCONNECT: return void 0 === e; case Ut.CONNECT_ERROR: return "string" == typeof e || "object" === Nt(e); case Ut.EVENT: case Ut.BINARY_EVENT: return Array.isArray(e) && e.length > 0; case Ut.ACK: case Ut.BINARY_ACK: return Array.isArray(e) } } }]), o }(f.Q), $t = function() { function t(e) { Ht(this, t), this.packet = e, this.buffers = [], this.reconPack = e } return zt(t, [{ key: "takeBinaryData", value: function(t) { if (this.buffers.push(t), this.buffers.length === this.reconPack.attachments) { var e = Ct(this.reconPack, this.buffers); return this.finishedReconstruction(), e } return null } }, { key: "finishedReconstruction", value: function() { this.reconPack = null, this.buffers = [] } }]), t }(); function Kt(t, e, n) { return t.on(e, n), function() { t.off(e, n) } } function Jt(t) { return Jt = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function(t) { return _typeof(t) } : function(t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : _typeof(t) }, Jt(t) } function Xt(t, e) { (null == e || e > t.length) && (e = t.length); for (var n = 0, r = new Array(e); n < e; n++)r[n] = t[n]; return r } function Qt() { return Qt = "undefined" != typeof Reflect && Reflect.get ? Reflect.get : function(t, e, n) { var r = Gt(t, e); if (r) { var o = Object.getOwnPropertyDescriptor(r, e); return o.get ? o.get.call(arguments.length < 3 ? t : n) : o.value } }, Qt.apply(this, arguments) } function Gt(t, e) { for (; !Object.prototype.hasOwnProperty.call(t, e) && null !== (t = ee(t));); return t } function Zt(t, e) { return Zt = Object.setPrototypeOf || function(t, e) { return t.__proto__ = e, t }, Zt(t, e) } function te(t, e) { if (e && ("object" === Jt(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return function(t) { if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return t }(t) } function ee(t) { return ee = Object.setPrototypeOf ? Object.getPrototypeOf : function(t) { return t.__proto__ || Object.getPrototypeOf(t) }, ee(t) } var ne = Object.freeze({ connect: 1, connect_error: 1, disconnect: 1, disconnecting: 1, newListener: 1, removeListener: 1 }), re = function(t) { !function(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), e && Zt(t, e) }(i, t); var e, n, r, o = (n = i, r = function() { if ("undefined" == typeof Reflect || !Reflect.construct) return !1; if (Reflect.construct.sham) return !1; if ("function" == typeof Proxy) return !0; try { return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() { }))), !0 } catch (t) { return !1 } }(), function() { var t, e = ee(n); if (r) { var o = ee(this).constructor; t = Reflect.construct(e, arguments, o) } else t = e.apply(this, arguments); return te(this, t) }); function i(t, e, n) { var r; return function(t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") }(this, i), (r = o.call(this)).connected = !1, r.disconnected = !0, r.receiveBuffer = [], r.sendBuffer = [], r.ids = 0, r.acks = {}, r.flags = {}, r.io = t, r.nsp = e, n && n.auth && (r.auth = n.auth), r.io._autoConnect && r.open(), r } return e = [{ key: "subEvents", value: function() { if (!this.subs) { var t = this.io; this.subs = [Kt(t, "open", this.onopen.bind(this)), Kt(t, "packet", this.onpacket.bind(this)), Kt(t, "error", this.onerror.bind(this)), Kt(t, "close", this.onclose.bind(this))] } } }, { key: "active", get: function() { return !!this.subs } }, { key: "connect", value: function() { return this.connected || (this.subEvents(), this.io._reconnecting || this.io.open(), "open" === this.io._readyState && this.onopen()), this } }, { key: "open", value: function() { return this.connect() } }, { key: "send", value: function() { for (var t = arguments.length, e = new Array(t), n = 0; n < t; n++)e[n] = arguments[n]; return e.unshift("message"), this.emit.apply(this, e), this } }, { key: "emit", value: function(t) { if (ne.hasOwnProperty(t)) throw new Error('"' + t + '" is a reserved event name'); for (var e = arguments.length, n = new Array(e > 1 ? e - 1 : 0), r = 1; r < e; r++)n[r - 1] = arguments[r]; n.unshift(t); var o = { type: Ut.EVENT, data: n, options: {} }; if (o.options.compress = !1 !== this.flags.compress, "function" == typeof n[n.length - 1]) { var i = this.ids++, s = n.pop(); this._registerAckCallback(i, s), o.id = i } var a = this.io.engine && this.io.engine.transport && this.io.engine.transport.writable, c = this.flags.volatile && (!a || !this.connected); return c || (this.connected ? this.packet(o) : this.sendBuffer.push(o)), this.flags = {}, this } }, { key: "_registerAckCallback", value: function(t, e) { var n = this, r = this.flags.timeout; if (void 0 !== r) { var o = this.io.setTimeoutFn((function() { delete n.acks[t]; for (var r = 0; r < n.sendBuffer.length; r++)n.sendBuffer[r].id === t && n.sendBuffer.splice(r, 1); e.call(n, new Error("operation has timed out")) }), r); this.acks[t] = function() { n.io.clearTimeoutFn(o); for (var t = arguments.length, r = new Array(t), i = 0; i < t; i++)r[i] = arguments[i]; e.apply(n, [null].concat(r)) } } else this.acks[t] = e } }, { key: "packet", value: function(t) { t.nsp = this.nsp, this.io._packet(t) } }, { key: "onopen", value: function() { var t = this; "function" == typeof this.auth ? this.auth((function(e) { t.packet({ type: Ut.CONNECT, data: e }) })) : this.packet({ type: Ut.CONNECT, data: this.auth }) } }, { key: "onerror", value: function(t) { this.connected || this.emitReserved("connect_error", t) } }, { key: "onclose", value: function(t) { this.connected = !1, this.disconnected = !0, delete this.id, this.emitReserved("disconnect", t) } }, { key: "onpacket", value: function(t) { if (t.nsp === this.nsp) switch (t.type) { case Ut.CONNECT: if (t.data && t.data.sid) { var e = t.data.sid; this.onconnect(e) } else this.emitReserved("connect_error", new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)")); break; case Ut.EVENT: case Ut.BINARY_EVENT: this.onevent(t); break; case Ut.ACK: case Ut.BINARY_ACK: this.onack(t); break; case Ut.DISCONNECT: this.ondisconnect(); break; case Ut.CONNECT_ERROR: this.destroy(); var n = new Error(t.data.message); n.data = t.data.data, this.emitReserved("connect_error", n) } } }, { key: "onevent", value: function(t) { var e = t.data || []; null != t.id && e.push(this.ack(t.id)), this.connected ? this.emitEvent(e) : this.receiveBuffer.push(Object.freeze(e)) } }, { key: "emitEvent", value: function(t) { if (this._anyListeners && this._anyListeners.length) { var e, n = function(t, e) { var n = "undefined" != typeof Symbol && t[Symbol.iterator] || t["@@iterator"]; if (!n) { if (Array.isArray(t) || (n = function(t, e) { if (t) { if ("string" == typeof t) return Xt(t, e); var n = Object.prototype.toString.call(t).slice(8, -1); return "Object" === n && t.constructor && (n = t.constructor.name), "Map" === n || "Set" === n ? Array.from(t) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? Xt(t, e) : void 0 } }(t))) { n && (t = n); var r = 0, o = function() { }; return { s: o, n: function() { return r >= t.length ? { done: !0 } : { done: !1, value: t[r++] } }, e: function(t) { throw t }, f: o } } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") } var i, s = !0, a = !1; return { s: function() { n = n.call(t) }, n: function() { var t = n.next(); return s = t.done, t }, e: function(t) { a = !0, i = t }, f: function() { try { s || null == n.return || n.return() } finally { if (a) throw i } } } }(this._anyListeners.slice()); try { for (n.s(); !(e = n.n()).done;)e.value.apply(this, t) } catch (t) { n.e(t) } finally { n.f() } } Qt(ee(i.prototype), "emit", this).apply(this, t) } }, { key: "ack", value: function(t) { var e = this, n = !1; return function() { if (!n) { n = !0; for (var r = arguments.length, o = new Array(r), i = 0; i < r; i++)o[i] = arguments[i]; e.packet({ type: Ut.ACK, id: t, data: o }) } } } }, { key: "onack", value: function(t) { var e = this.acks[t.id]; "function" == typeof e && (e.apply(this, t.data), delete this.acks[t.id]) } }, { key: "onconnect", value: function(t) { this.id = t, this.connected = !0, this.disconnected = !1, this.emitBuffered(), this.emitReserved("connect") } }, { key: "emitBuffered", value: function() { var t = this; this.receiveBuffer.forEach((function(e) { return t.emitEvent(e) })), this.receiveBuffer = [], this.sendBuffer.forEach((function(e) { return t.packet(e) })), this.sendBuffer = [] } }, { key: "ondisconnect", value: function() { this.destroy(), this.onclose("io server disconnect") } }, { key: "destroy", value: function() { this.subs && (this.subs.forEach((function(t) { return t() })), this.subs = void 0), this.io._destroy(this) } }, { key: "disconnect", value: function() { return this.connected && this.packet({ type: Ut.DISCONNECT }), this.destroy(), this.connected && this.onclose("io client disconnect"), this } }, { key: "close", value: function() { return this.disconnect() } }, { key: "compress", value: function(t) { return this.flags.compress = t, this } }, { key: "volatile", get: function() { return this.flags.volatile = !0, this } }, { key: "timeout", value: function(t) { return this.flags.timeout = t, this } }, { key: "onAny", value: function(t) { return this._anyListeners = this._anyListeners || [], this._anyListeners.push(t), this } }, { key: "prependAny", value: function(t) { return this._anyListeners = this._anyListeners || [], this._anyListeners.unshift(t), this } }, { key: "offAny", value: function(t) { if (!this._anyListeners) return this; if (t) { for (var e = this._anyListeners, n = 0; n < e.length; n++)if (t === e[n]) return e.splice(n, 1), this } else this._anyListeners = []; return this } }, { key: "listenersAny", value: function() { return this._anyListeners || [] } }], e && function(t, e) { for (var n = 0; n < e.length; n++) { var r = e[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(t, r.key, r) } }(i.prototype, e), i }(f.Q), oe = n(28); function ie(t) { return ie = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function(t) { return _typeof(t) } : function(t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : _typeof(t) }, ie(t) } function se(t, e) { return se = Object.setPrototypeOf || function(t, e) { return t.__proto__ = e, t }, se(t, e) } function ae(t, e) { if (e && ("object" === ie(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return ce(t) } function ce(t) { if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return t } function ue(t) { return ue = Object.setPrototypeOf ? Object.getPrototypeOf : function(t) { return t.__proto__ || Object.getPrototypeOf(t) }, ue(t) } var fe = function(e) { !function(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), e && se(t, e) }(s, e); var n, r, o, i = (r = s, o = function() { if ("undefined" == typeof Reflect || !Reflect.construct) return !1; if (Reflect.construct.sham) return !1; if ("function" == typeof Proxy) return !0; try { return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() { }))), !0 } catch (t) { return !1 } }(), function() { var t, e = ue(r); if (o) { var n = ue(this).constructor; t = Reflect.construct(e, arguments, n) } else t = e.apply(this, arguments); return ae(this, t) }); function s(e, n) { var r, o; !function(t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") }(this, s), (r = i.call(this)).nsps = {}, r.subs = [], e && "object" === ie(e) && (n = e, e = void 0), (n = n || {}).path = n.path || "/socket.io", r.opts = n, u(ce(r), n), r.reconnection(!1 !== n.reconnection), r.reconnectionAttempts(n.reconnectionAttempts || 1 / 0), r.reconnectionDelay(n.reconnectionDelay || 1e3), r.reconnectionDelayMax(n.reconnectionDelayMax || 5e3), r.randomizationFactor(null !== (o = n.randomizationFactor) && void 0 !== o ? o : .5), r.backoff = new oe({ min: r.reconnectionDelay(), max: r.reconnectionDelayMax(), jitter: r.randomizationFactor() }), r.timeout(null == n.timeout ? 2e4 : n.timeout), r._readyState = "closed", r.uri = e; var a = n.parser || t; return r.encoder = new a.Encoder, r.decoder = new a.Decoder, r._autoConnect = !1 !== n.autoConnect, r._autoConnect && r.open(), r } return n = [{ key: "reconnection", value: function(t) { return arguments.length ? (this._reconnection = !!t, this) : this._reconnection } }, { key: "reconnectionAttempts", value: function(t) { return void 0 === t ? this._reconnectionAttempts : (this._reconnectionAttempts = t, this) } }, { key: "reconnectionDelay", value: function(t) { var e; return void 0 === t ? this._reconnectionDelay : (this._reconnectionDelay = t, null === (e = this.backoff) || void 0 === e || e.setMin(t), this) } }, { key: "randomizationFactor", value: function(t) { var e; return void 0 === t ? this._randomizationFactor : (this._randomizationFactor = t, null === (e = this.backoff) || void 0 === e || e.setJitter(t), this) } }, { key: "reconnectionDelayMax", value: function(t) { var e; return void 0 === t ? this._reconnectionDelayMax : (this._reconnectionDelayMax = t, null === (e = this.backoff) || void 0 === e || e.setMax(t), this) } }, { key: "timeout", value: function(t) { return arguments.length ? (this._timeout = t, this) : this._timeout } }, { key: "maybeReconnectOnOpen", value: function() { !this._reconnecting && this._reconnection && 0 === this.backoff.attempts && this.reconnect() } }, { key: "open", value: function(t) { var e = this; if (~this._readyState.indexOf("open")) return this; this.engine = new kt(this.uri, this.opts); var n = this.engine, r = this; this._readyState = "opening", this.skipReconnect = !1; var o = Kt(n, "open", (function() { r.onopen(), t && t() })), i = Kt(n, "error", (function(n) { r.cleanup(), r._readyState = "closed", e.emitReserved("error", n), t ? t(n) : r.maybeReconnectOnOpen() })); if (!1 !== this._timeout) { var s = this._timeout; 0 === s && o(); var a = this.setTimeoutFn((function() { o(), n.close(), n.emit("error", new Error("timeout")) }), s); this.opts.autoUnref && a.unref(), this.subs.push((function() { clearTimeout(a) })) } return this.subs.push(o), this.subs.push(i), this } }, { key: "connect", value: function(t) { return this.open(t) } }, { key: "onopen", value: function() { this.cleanup(), this._readyState = "open", this.emitReserved("open"); var t = this.engine; this.subs.push(Kt(t, "ping", this.onping.bind(this)), Kt(t, "data", this.ondata.bind(this)), Kt(t, "error", this.onerror.bind(this)), Kt(t, "close", this.onclose.bind(this)), Kt(this.decoder, "decoded", this.ondecoded.bind(this))) } }, { key: "onping", value: function() { this.emitReserved("ping") } }, { key: "ondata", value: function(t) { this.decoder.add(t) } }, { key: "ondecoded", value: function(t) { this.emitReserved("packet", t) } }, { key: "onerror", value: function(t) { this.emitReserved("error", t) } }, { key: "socket", value: function(t, e) { var n = this.nsps[t]; return n || (n = new re(this, t, e), this.nsps[t] = n), n } }, { key: "_destroy", value: function(t) { for (var e = 0, n = Object.keys(this.nsps); e < n.length; e++) { var r = n[e]; if (this.nsps[r].active) return } this._close() } }, { key: "_packet", value: function(t) { for (var e = this.encoder.encode(t), n = 0; n < e.length; n++)this.engine.write(e[n], t.options) } }, { key: "cleanup", value: function() { this.subs.forEach((function(t) { return t() })), this.subs.length = 0, this.decoder.destroy() } }, { key: "_close", value: function() { this.skipReconnect = !0, this._reconnecting = !1, this.onclose("forced close"), this.engine && this.engine.close() } }, { key: "disconnect", value: function() { return this._close() } }, { key: "onclose", value: function(t) { this.cleanup(), this.backoff.reset(), this._readyState = "closed", this.emitReserved("close", t), this._reconnection && !this.skipReconnect && this.reconnect() } }, { key: "reconnect", value: function() { var t = this; if (this._reconnecting || this.skipReconnect) return this; var e = this; if (this.backoff.attempts >= this._reconnectionAttempts) this.backoff.reset(), this.emitReserved("reconnect_failed"), this._reconnecting = !1; else { var n = this.backoff.duration(); this._reconnecting = !0; var r = this.setTimeoutFn((function() { e.skipReconnect || (t.emitReserved("reconnect_attempt", e.backoff.attempts), e.skipReconnect || e.open((function(n) { n ? (e._reconnecting = !1, e.reconnect(), t.emitReserved("reconnect_error", n)) : e.onreconnect() }))) }), n); this.opts.autoUnref && r.unref(), this.subs.push((function() { clearTimeout(r) })) } } }, { key: "onreconnect", value: function() { var t = this.backoff.attempts; this._reconnecting = !1, this.backoff.reset(), this.emitReserved("reconnect", t) } }], n && function(t, e) { for (var n = 0; n < e.length; n++) { var r = e[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(t, r.key, r) } }(s.prototype, n), s }(f.Q); function le() { return le = Object.assign || function(t) { for (var e = 1; e < arguments.length; e++) { var n = arguments[e]; for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (t[r] = n[r]) } return t }, le.apply(this, arguments) } function he(t) { return he = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function(t) { return _typeof(t) } : function(t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : _typeof(t) }, he(t) } var pe = {}; function ye(t, n) { "object" === he(t) && (n = t, t = void 0); var r, o = function(t) { var n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : "", r = arguments.length > 2 ? arguments[2] : void 0, o = t; r = r || "undefined" != typeof location && location, null == t && (t = r.protocol + "//" + r.host), "string" == typeof t && ("/" === t.charAt(0) && (t = "/" === t.charAt(1) ? r.protocol + t : r.host + t), /^(https?|wss?):\/\//.test(t) || (t = void 0 !== r ? r.protocol + "//" + t : "https://" + t), o = e(t)), o.port || (/^(http|ws)$/.test(o.protocol) ? o.port = "80" : /^(http|ws)s$/.test(o.protocol) && (o.port = "443")), o.path = o.path || "/"; var i = -1 !== o.host.indexOf(":") ? "[" + o.host + "]" : o.host; return o.id = o.protocol + "://" + i + ":" + o.port + n, o.href = o.protocol + "://" + i + (r && r.port === o.port ? "" : ":" + o.port), o }(t, (n = n || {}).path || "/socket.io"), i = o.source, s = o.id, a = o.path, c = pe[s] && a in pe[s].nsps; return n.forceNew || n["force new connection"] || !1 === n.multiplex || c ? r = new fe(i, n) : (pe[s] || (pe[s] = new fe(i, n)), r = pe[s]), o.query && !n.query && (n.query = o.queryKey), r.socket(o.path, n) } le(ye, { Manager: fe, Socket: re, io: ye, connect: ye }); var de = ye.connect(location.href, { reconnect: !1, transports: ["websocket"], upgrade: !1 }), ve = function t() { var e = 0, n = document.createElement("div"); function r(t) { return n.appendChild(t.dom), t } function o(t) { for (var r = 0; r < n.children.length; r++)n.children[r].style.display = r === t ? "block" : "none"; e = t } n.style.cssText = "position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000", n.addEventListener("click", (function(t) { t.preventDefault(), o(++e % n.children.length) }), !1); var i = (performance || Date).now(), s = i, a = 0, c = r(new t.Panel("FPS", "#0ff", "#002")), u = r(new t.Panel("MS", "#0f0", "#020")); if (self.performance && self.performance.memory) var f = r(new t.Panel("MB", "#f08", "#201")); return o(0), { REVISION: 16, dom: n, addPanel: r, showPanel: o, begin: function() { i = (performance || Date).now() }, end: function() { a++; var t = (performance || Date).now(); if (u.update(t - i, 200), t >= s + 1e3 && (c.update(1e3 * a / (t - s), 100), s = t, a = 0, f)) { var e = performance.memory; f.update(e.usedJSHeapSize / 1048576, e.jsHeapSizeLimit / 1048576) } return t }, update: function() { i = this.end() }, domElement: n, setMode: o } }; ve.Panel = function(t, e, n) { var r = 1 / 0, o = 0, i = Math.round, s = i(window.devicePixelRatio || 1), a = 80 * s, c = 48 * s, u = 3 * s, f = 2 * s, l = 3 * s, h = 15 * s, p = 74 * s, y = 30 * s, d = document.createElement("canvas"); d.width = a, d.height = c, d.style.cssText = "width:80px;height:48px"; var v = d.getContext("2d"); return v.font = "bold " + 9 * s + "px Helvetica,Arial,sans-serif", v.textBaseline = "top", v.fillStyle = n, v.fillRect(0, 0, a, c), v.fillStyle = e, v.fillText(t, u, f), v.fillRect(l, h, p, y), v.fillStyle = n, v.globalAlpha = .9, v.fillRect(l, h, p, y), { dom: d, update: function(c, m) { r = Math.min(r, c), o = Math.max(o, c), v.fillStyle = n, v.globalAlpha = 1, v.fillRect(0, 0, a, h), v.fillStyle = e, v.fillText(i(c) + " " + t + " (" + i(r) + "-" + i(o) + ")", u, f), v.drawImage(d, l + s, h, p - s, y, l, h, p - s, y), v.fillRect(l + p - s, h, s, y), v.fillStyle = n, v.globalAlpha = .9, v.fillRect(l + p - s, h, s, i((1 - c / m) * y)) } } }; var me = ve; function be(t, e) { var n = "undefined" != typeof Symbol && t[Symbol.iterator] || t["@@iterator"]; if (!n) { if (Array.isArray(t) || (n = function(t, e) { if (t) { if ("string" == typeof t) return ge(t, e); var n = Object.prototype.toString.call(t).slice(8, -1); return "Object" === n && t.constructor && (n = t.constructor.name), "Map" === n || "Set" === n ? Array.from(t) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? ge(t, e) : void 0 } }(t)) || e && t && "number" == typeof t.length) { n && (t = n); var r = 0, o = function() { }; return { s: o, n: function() { return r >= t.length ? { done: !0 } : { done: !1, value: t[r++] } }, e: function(t) { throw t }, f: o } } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") } var i, s = !0, a = !1; return { s: function() { n = n.call(t) }, n: function() { var t = n.next(); return s = t.done, t }, e: function(t) { a = !0, i = t }, f: function() { try { s || null == n.return || n.return() } finally { if (a) throw i } } } } function ge(t, e) { (null == e || e > t.length) && (e = t.length); for (var n = 0, r = new Array(e); n < e; n++)r[n] = t[n]; return r } var we = function() { function t(e) { var n = this; !function(t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") }(this, t), this.socket = e, this.stats = new me, document.body.appendChild(this.stats.dom), this.stats.dom.id = "stats", this.stats.dom.style.cssText = "", this.canvas = document.getElementById("container").appendChild(document.createElement("canvas")), this.canvas.width = window.innerWidth, this.canvas.height = window.innerHeight, this.canvas.style.cssText = "\n\t\t\twidth: 100%;\n\t\t\theight: 100vh;\n\t\t\ttop: 0;\n\t\t\tleft: 0;\n\t\t\tposition: fixed;\n\t\t", this.ctx = this.canvas.getContext("2d"), this.mini = document.getElementById("container").appendChild(document.createElement("div")).appendChild(document.createElement("canvas")), this.mini.style.cssText = "\n\t\t\twidth: 150px;\n\t\t\theight: 150px;\n\t\t\tbottom: 70px;\n\t\t\tright: 30px;\n\t\t\tposition: fixed;\n\t\t\tborder: 7px solid black;\n\t\t\tbackground: white;\n\t\t\tz-index: 105;\n\t\t", this.mini.width = this.mini.offsetWidth, this.mini.height = this.mini.offsetHeight, this.mini.ctx = this.mini.getContext("2d"), this.mini.ctx.fillStyle = "white", this.mini.ctx.fillRect(0, 0, 30, 30), window.addEventListener("keydown", (function(t) { })), this.startPingPong(), this.main = [], this.static = {}, this.socket.on("init", (function(t) { n.static = t, $("#username").maxLength = n.static.maxNameLength, n.update() })), e.on("update", (function(t) { n.main = t })), e.on("lightning", this.lightning.bind(this)), this.bg = new Image, this.bg.addEventListener("load", (function() { n.bgPattern = n.ctx.createPattern(n.bg, "repeat") })), this.bg.src = location.origin + "/assets/bg.png", setInterval(this.fps.bind(this), 1e3), this.frames = 0, window.addEventListener("resize", (function() { n.canvas.width = window.innerWidth, n.canvas.height = window.innerHeight })), $("#start form").on("submit", (function(t) { t.preventDefault(), n.init() })), this.socket.on("disconnect", (function() { alert("Connection to the server has been lost.") })), $("#wait").style.display = "none" } var e; return e = [{ key: "init", value: function() { var t = this; this.socket.emit("init", { name: $("#start form #username").value, color: $("#start form #color").value }), $("#start").style.display = "none", this.socket.on("id", (function(e) { t.static.id = e })), this.angle = 0, window.addEventListener("mousemove", (function(e) { var n = e.clientX - window.innerWidth / 2, r = e.clientY - window.innerHeight / 2; t.angle = Math.atan2(r, n), t.socket.emit("angle", t.angle) })) } }, { key: "fps", value: function() { document.getElementById("fps").innerHTML = this.frames, this.frames = 0 } }, { key: "lightning", value: function(t, e) { this.lightnings.push(new Lightinig(t, e, { fadeTime: 200 })) } }, { key: "startPingPong", value: function() { var t = this, e = performance.now(), n = function() { e = performance.now(), t.socket.emit("ping") }; this.socket.on("pong", (function() { var t = performance.now(); document.getElementById("ping").innerHTML = Math.round(t - e).toString(), setTimeout(n, 1e3) })), n() } }, { key: "update", value: function() { try { if (this.ctx.fillStyle = "white", this.ctx.fillRect(0, 0, window.innerWidth, window.innerHeight), this.initData === {}) return requestAninimationFrame(this.update.bind(this)); var t, e, n = be(this.main); try { for (n.s(); !(e = n.n()).done;) { var r = e.value; if (r.id === this.static.id) { t = r.pos; break } } } catch (t) { n.e(t) } finally { n.f() } t || (t = { x: 0, y: 0 }), this.pos = t, this.ctx.fillStyle = this.bgPattern || "white", this.ctx.save(), this.ctx.translate(window.innerWidth / 2 + (0 - t.x), window.innerHeight / 2 + (0 - t.y)), this.ctx.fillRect(t.x - window.innerWidth / 2, t.y - window.innerHeight / 2, window.innerWidth, window.innerHeight), this.ctx.restore(), this.ctx.lineWidth = 10, this.ctx.strokeStyle = "black", this.ctx.strokeRect(window.innerWidth / 2 + (-this.static.boardSize / 2 - t.x), window.innerHeight / 2 + (-this.static.boardSize / 2 - t.y), this.static.boardSize, this.static.boardSize); var o, i = be(this.main); try { for (i.s(); !(o = i.n()).done;) { var s = o.value; this.ctx.save(), this.ctx.translate(window.innerWidth / 2 + (s.pos.x - t.x), window.innerHeight / 2 + (s.pos.y - t.y)), this.ctx.rotate(s.angle - Math.PI / 2), this.drawPlayer(s.color, s.radius, -s.angle + Math.PI / 2, s.name), this.ctx.restore(), s.id === this.static.id && (this.mini.ctx.clearRect(0, 0, this.mini.width, this.mini.height), this.mini.ctx.fillStyle = s.color, this.mini.ctx.beginPath(), this.mini.ctx.arc((s.pos.x + this.static.boardSize / 2) / (this.static.boardSize / this.mini.width), (s.pos.y + this.static.boardSize / 2) / (this.static.boardSize / this.mini.height), this.mini.width / 20, 0, 2 * Math.PI), this.mini.ctx.fill()) } } catch (t) { i.e(t) } finally { i.f() } requestAnimationFrame(this.update.bind(this)), this.frames += 1, this.stats.update() } catch (t) { alert(t.stack || t.message) } } }, { key: "drawPlayer", value: function(t) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 20, n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0, r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : "player", o = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 10, i = arguments.length > 5 && void 0 !== arguments[5] && arguments[5]; this.ctx.lineWidth = 2 * e / 50, this.ctx.fillStyle = t, this.ctx.strokeStyle = "black", this.ctx.beginPath(), this.ctx.arc(0, 0, e, 0, 2 * Math.PI), this.ctx.fill(), this.ctx.stroke(), this.ctx.beginPath(), this.ctx.arc(1.3 * e, 1.3 * e, e / 2.5, 0, 2 * Math.PI), this.ctx.fill(), this.ctx.stroke(), this.ctx.beginPath(), this.ctx.arc(1.3 * -e, 1.3 * e, e / 2.5, 0, 2 * Math.PI), this.ctx.fill(), this.ctx.stroke(), "shield" === i && (this.ctx.beginPath(), this.ctx.moveTo(1.2 * -e, 1.2 * e), this.ctx.lineTo(0, 1.8 * e), this.ctx.lineTo(1.2 * e, 1.2 * e), this.ctx.lineWidth = 6 * e / 50, this.ctx.stroke()), this.ctx.rotate(n), this.ctx.font = "20px Arial", this.ctx.textAlign = "center", this.ctx.fillStyle = "black", this.ctx.fillText(r.toString(), 0, 1.3 * -e - e / 2.5 - 50), o < 100 && this.drawHealthBar(o, 1.3 * -e - e / 2.5 - 40) } }, { key: "drawHealthBar", value: function(t, e) { this.ctx.fillStyle = "grey", this.ctx.fillRect(-40, e, 80, 20), this.ctx.fillStyle = t > 60 ? "#00ff00" : t > 20 ? "#ffff00" : "#ff0000", this.ctx.fillRect(-37, e + 3, t / 100 * 74, 14) } }], e && function(t, e) { for (var n = 0; n < e.length; n++) { var r = e[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(t, r.key, r) } }(t.prototype, e), t }(); window.socket = de, de.on("connect", (function() { console.log("connected to server"), window.game = new we(de) })) }() }();